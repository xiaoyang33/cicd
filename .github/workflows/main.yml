name: CICD

on: push

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: 迁出代码
        uses: actions/checkout@v2
        
      - name: 安装 nodejs
        uses: actions/setup-node@v2
        with:
          node-version: "14"
      - name: 安装依赖
        run: npm install
        
      - name: 上传阿里云
        uses: easingthemes/ssh-deploy@v2.1.1
        env:
                  # 私钥
                  SSH_PRIVATE_KEY: ${{ secrets.ALIROOT }}
                  # scp参数
                  ARGS: '-avzr --delete'
                  # 源目录
                  SOURCE: 'dist'
                  # 服务器ip：换成你的服务器IP
                  REMOTE_HOST: ${{ secrets.ALIROOTHOST }}
                  # 用户
                  REMOTE_USER: 'root'
                  # 目标地址
                  TARGET: '/www/wwwroot/xxlb.site'

      - name: Run a one-line script
        run: echo "Hello, world!"
